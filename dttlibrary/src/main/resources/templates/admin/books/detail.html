<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi">
<head>
    <meta charset="UTF-8">
    <title th:text="${book.title}">Book Detail</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/dashboard.css">
</head>

<body>
<div class="container-fluid">
    <div class="row">

        <!-- ===== SIDEBAR ===== -->
        <div class="col-md-2 sidebar">
            <h4>üìö DTT Library</h4>
            <a href="/user/home">Home</a>
            <a href="/books" class="active">Books</a>
            <a href="/user/my-borrowings">My Borrowings</a>
            <hr>
            <a href="/logout" class="text-danger">Logout</a>
        </div>

        <!-- ===== MAIN ===== -->
        <div class="col-md-10 main">
            <h3 class="page-title mb-4">üìñ Book Details</h3>

            <div class="card shadow-sm">
                <div class="card-body">
                    <div class="row">

                        <!-- ===== IMAGE ===== -->
                        <div class="col-md-4 text-center">
                            <img th:if="${primaryImage != null}"
                                 th:src="${primaryImage.url}"
                                 class="img-fluid rounded shadow-sm mb-3"
                                 style="max-height:300px; object-fit:cover">

                            <div th:if="${primaryImage == null}"
                                 class="border rounded p-4 text-muted">
                                No Image
                            </div>
                        </div>

                        <!-- ===== INFO ===== -->
                        <div class="col-md-8">

                            <h4 th:text="${book.title}">Book Title</h4>

                            <p>
                                <strong>Category:</strong>
                                <span th:text="${book.category != null ? book.category.name : 'N/A'}"></span>
                            </p>

                            <p>
                                <strong>Author:</strong>
                                <span th:text="${book.author != null ? book.author.name : 'Unknown'}"></span>
                            </p>

                            <p>
                                <strong>ISBN:</strong>
                                <span th:text="${book.isbn}"></span>
                            </p>

                            <p>
                                <strong>Description:</strong><br>
                                <span th:text="${book.description}"></span>
                            </p>

                            <p class="mt-3">
                                <strong>Available copies:</strong>
                                <span class="badge bg-success" th:text="${available}">0</span>
                            </p>

                            <hr>

                            <!-- ===== BORROW BUTTON ===== -->
                            <form th:if="${bookItem != null}"
                                  th:action="@{/user/borrow/{id}(id=${bookItem.id})}"
                                  method="post">

                                <button class="btn btn-success px-4">
                                    üìö Borrow this book
                                </button>
                            </form>

                            <button th:if="${bookItem == null}"
                                    class="btn btn-secondary px-4"
                                    disabled>
                                ‚ùå Not Available
                            </button>

                            <div class="mt-3">
                                <a href="/books" class="btn btn-outline-secondary">
                                    ‚Üê Back to books
                                </a>
                            </div>

                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>

</body>
</html>
