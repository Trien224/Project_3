<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      th:replace="layout/user-layout :: layout(
          title='S√°ch ƒëang m∆∞·ª£n',
          content=~{::content})">

<div th:fragment="content">

    <h3 class="text-primary mb-4">üìò L·ªãch s·ª≠ m∆∞·ª£n s√°ch</h3>

    <div th:if="${borrowings.isEmpty()}" class="alert alert-info">
        B·∫°n ch∆∞a m∆∞·ª£n cu·ªën s√°ch n√†o.
    </div>

    <table th:if="${!borrowings.isEmpty()}" class="table table-bordered shadow-sm bg-white align-middle">
        <thead class="table-primary">
        <tr>
            <th>T√™n s√°ch</th>
            <th>Ng√†y m∆∞·ª£n</th>
            <th>H·∫°n tr·∫£</th>
            <th>Ng√†y tr·∫£</th>
            <th>Tr·∫°ng th√°i</th>
            <th>H√†nh ƒë·ªông</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="b : ${borrowings}">
            <td th:text="${b.bookItem.book.title}">T√™n s√°ch</td>
            <td th:text="${#temporals.format(b.borrowDate, 'dd/MM/yyyy HH:mm')}"></td>
            <td th:text="${#temporals.format(b.dueDate, 'dd/MM/yyyy')}"></td>
            <td th:text="${b.returnDate != null ? #temporals.format(b.returnDate, 'dd/MM/yyyy HH:mm') : '-'}"></td>
            <td>
                <span th:switch="${b.status.name()}" class="badge"
                      th:classappend="${b.status.name() == 'borrowed' ? 'bg-warning' :
                                       (b.status.name() == 'returned' ? 'bg-success' :
                                       (b.status.name() == 'overdue' ? 'bg-danger' : 'bg-secondary'))}">
                    <span th:case="'borrowed'">ƒêang m∆∞·ª£n</span>
                    <span th:case="'returned'">ƒê√£ tr·∫£</span>
                    <span th:case="'overdue'">Qu√° h·∫°n</span>
                    <span th:case="*">Kh√°c</span>
                </span>
            </td>
            <td>
                <a th:if="${b.status.name() == 'borrowed' or b.status.name() == 'overdue'}"
                   th:href="@{/borrowings/return/{id}(id=${b.id})}"
                   class="btn btn-sm btn-outline-primary"
                   onclick="return confirm('B·∫°n c√≥ ch·∫Øc mu·ªën tr·∫£ s√°ch n√†y?')">
                    Tr·∫£ s√°ch
                </a>
            </td>
        </tr>
        </tbody>
    </table>

</div>
</html>
