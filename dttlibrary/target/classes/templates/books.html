<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title>Books | DTT Library</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        body {
            background-color: #f8f9fa;
        }
        .card {
            border: none;
            border-radius: 8px;
            transition: transform 0.2s ease;
        }
        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .card-title {
            font-weight: 600;
        }
        .card-text {
            font-size: 0.95rem;
            color: #6c757d;
        }
        .btn-primary {
            border-radius: 6px;
        }
        .badge-available {
            background-color: #198754;
        }
        .badge-unavailable {
            background-color: #dc3545;
        }
    </style>
</head>

<body>

<!-- ‚úÖ Header fragment -->
<div th:replace="~{layout/header :: header}"></div>

<!-- ‚úÖ Main content -->
<div class="container my-4">
    <h2 class="mb-4 text-center">üìö Danh s√°ch S√°ch</h2>

    <div class="row g-4">
        <!-- Loop qua danh s√°ch s√°ch -->
        <div class="col-sm-6 col-md-4 col-lg-3" th:each="book : ${books}">
            <div class="card h-100 shadow-sm">
                <div class="card-body d-flex flex-column justify-content-between">
                    <div>
                        <h5 class="card-title" th:text="${book.title}">T√™n s√°ch</h5>
                        <p class="card-text" th:text="${book.category.name}">Th·ªÉ lo·∫°i</p>

                        <!-- Hi·ªÉn th·ªã tr·∫°ng th√°i -->
                        <div class="mb-2">
                            <span class="badge"
                                  th:classappend="${book.availableItems > 0} ? 'badge-available' : 'badge-unavailable'"
                                  th:text="${book.availableItems > 0 ? 'C√≤n ' + book.availableItems + ' b·∫£n' : 'H·∫øt s√°ch'}">
                                C√≤n 0 b·∫£n
                            </span>
                        </div>
                    </div>

                    <!-- N√∫t m∆∞·ª£n -->
                    <div th:if="${book.availableItems > 0}">
                        <form th:action="@{/borrowings/borrow}" method="post">
                            <input type="hidden" name="bookItemId" th:value="${book.bookItems[0].id}" />
                            <button type="submit" class="btn btn-primary w-100">üìñ M∆∞·ª£n s√°ch</button>
                        </form>
                    </div>

                    <!-- H·∫øt s√°ch -->
                    <div th:if="${book.availableItems == 0}">
                        <button class="btn btn-secondary w-100" disabled>‚ùå H·∫øt s√°ch</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- ‚úÖ Footer fragment -->
<div th:replace="~{layout/footer :: footer}"></div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
